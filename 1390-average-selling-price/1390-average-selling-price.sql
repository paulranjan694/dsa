# Write your MySQL query statement below
select product_id, ifnull(Round(total_price/total_units,2),0) as average_price from (select p.product_id as product_id, sum(u.units) as total_units, sum(p.price*u.units) as total_price from Prices p left join UnitsSold u on p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date group by p.product_id) as s;